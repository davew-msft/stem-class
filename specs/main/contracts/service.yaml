# Kubernetes Service for Rescan Application
# Educational Note: A Service provides a stable network endpoint for accessing pods
# Even when pods are recreated (with new IPs), the Service IP remains constant

apiVersion: v1
kind: Service
metadata:
  name: rescan-service
  namespace: rescan
  labels:
    app: rescan
  annotations:
    description: "Network access to Rescan application"
spec:
  # Service type determines how the service is exposed
  # ClusterIP: Internal only (default) - good for dev with 'kubectl port-forward'
  # LoadBalancer: External IP assigned by cloud provider - good for production
  # NodePort: Exposes on each node's IP at a static port - good for bare metal
  
  type: LoadBalancer  # Change to ClusterIP for internal-only access
  
  # Selector determines which pods receive traffic from this service
  # Pods must have matching labels
  selector:
    app: rescan
    component: backend
  
  ports:
  - name: http
    protocol: TCP
    port: 3000          # Port exposed by the service
    targetPort: 3000    # Port on the container (must match Deployment containerPort)
    # nodePort: 30080   # Uncomment for NodePort type (30000-32767 range)
  
  # Session affinity: route requests from same client IP to same pod
  # None: no affinity (default, good for stateless apps)
  # ClientIP: sticky sessions (good if app has session state)
  sessionAffinity: None
  
  # Educational Note:
  # - ClusterIP services get a DNS name: rescan-service.rescan.svc.cluster.local
  # - LoadBalancer services get an external IP (check with: kubectl get svc)
  # - Use 'kubectl port-forward svc/rescan-service 3000:3000' for local testing
